{'download': 'bash ./scripts/get_coco.sh', 'train': 'D:\\\\PycharmProject\\\\yolov7-main\\\\NEU-DET\\\\train.txt', 'val': 'D:\\\\PycharmProject\\\\yolov7-main\\\\NEU-DET\\\\val.txt', 'nc': 6, 'names': ['crazing', 'inclusion', 'patches', 'pitted_surface', 'rolled-in_scale', 'scratches']}
2025-05-29 16:20:54,727 - asyncio - ERROR - Task was destroyed but it is pending!
task: <Task pending name='Task-2' coro=<Event.wait() running at D:\python310\lib\asyncio\locks.py:213> wait_for=<Future cancelled>>
2025-05-29 16:21:01,550 - models.yolo - INFO - Overriding model.yaml nc=80 with nc=6
2025-05-29 16:21:02,194 - models.yolo - INFO -
                 from  n    params  module                                  arguments
2025-05-29 16:21:02,199 - models.yolo - INFO -   0                -1  1       928  物体检测.YOLO_LEARN.models.common.Conv      [3, 32, 3, 1]
2025-05-29 16:21:02,202 - models.yolo - INFO -   1                -1  1     18560  物体检测.YOLO_LEARN.models.common.Conv      [32, 64, 3, 2]
2025-05-29 16:21:02,204 - models.yolo - INFO -   2                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,207 - models.yolo - INFO -   3                -1  1     73984  物体检测.YOLO_LEARN.models.common.Conv      [64, 128, 3, 2]
2025-05-29 16:21:02,209 - models.yolo - INFO -   4                -1  1      8320  物体检测.YOLO_LEARN.models.common.Conv      [128, 64, 1, 1]
2025-05-29 16:21:02,210 - models.yolo - INFO -   5                -2  1      8320  物体检测.YOLO_LEARN.models.common.Conv      [128, 64, 1, 1]
2025-05-29 16:21:02,212 - models.yolo - INFO -   6                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,214 - models.yolo - INFO -   7                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,215 - models.yolo - INFO -   8                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,217 - models.yolo - INFO -   9                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,218 - models.yolo - INFO -  10  [-1, -3, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,219 - models.yolo - INFO -  11                -1  1     66048  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 1, 1]
2025-05-29 16:21:02,220 - models.yolo - INFO -  12                -1  1         0  物体检测.YOLO_LEARN.models.common.MP        []
2025-05-29 16:21:02,222 - models.yolo - INFO -  13                -1  1     33024  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 1, 1]
2025-05-29 16:21:02,223 - models.yolo - INFO -  14                -3  1     33024  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 1, 1]
2025-05-29 16:21:02,226 - models.yolo - INFO -  15                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 2]
2025-05-29 16:21:02,227 - models.yolo - INFO -  16          [-1, -3]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,228 - models.yolo - INFO -  17                -1  1     33024  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 1, 1]
2025-05-29 16:21:02,228 - models.yolo - INFO -  18                -2  1     33024  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 1, 1]
2025-05-29 16:21:02,231 - models.yolo - INFO -  19                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,233 - models.yolo - INFO -  20                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,235 - models.yolo - INFO -  21                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,236 - models.yolo - INFO -  22                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,238 - models.yolo - INFO -  23  [-1, -3, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,240 - models.yolo - INFO -  24                -1  1    263168  物体检测.YOLO_LEARN.models.common.Conv      [512, 512, 1, 1]
2025-05-29 16:21:02,241 - models.yolo - INFO -  25                -1  1         0  物体检测.YOLO_LEARN.models.common.MP        []
2025-05-29 16:21:02,244 - models.yolo - INFO -  26                -1  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,246 - models.yolo - INFO -  27                -3  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,250 - models.yolo - INFO -  28                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 2]
2025-05-29 16:21:02,250 - models.yolo - INFO -  29          [-1, -3]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,250 - models.yolo - INFO -  30                -1  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,253 - models.yolo - INFO -  31                -2  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,256 - models.yolo - INFO -  32                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,260 - models.yolo - INFO -  33                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,264 - models.yolo - INFO -  34                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,271 - models.yolo - INFO -  35                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,272 - models.yolo - INFO -  36  [-1, -3, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,288 - models.yolo - INFO -  37                -1  1   1050624  物体检测.YOLO_LEARN.models.common.Conv      [1024, 1024, 1, 1]
2025-05-29 16:21:02,290 - models.yolo - INFO -  38                -1  1         0  物体检测.YOLO_LEARN.models.common.MP        []
2025-05-29 16:21:02,293 - models.yolo - INFO -  39                -1  1    525312  物体检测.YOLO_LEARN.models.common.Conv      [1024, 512, 1, 1]
2025-05-29 16:21:02,298 - models.yolo - INFO -  40                -3  1    525312  物体检测.YOLO_LEARN.models.common.Conv      [1024, 512, 1, 1]
2025-05-29 16:21:02,318 - models.yolo - INFO -  41                -1  1   2360320  物体检测.YOLO_LEARN.models.common.Conv      [512, 512, 3, 2]
2025-05-29 16:21:02,319 - models.yolo - INFO -  42          [-1, -3]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,322 - models.yolo - INFO -  43                -1  1    262656  物体检测.YOLO_LEARN.models.common.Conv      [1024, 256, 1, 1]
2025-05-29 16:21:02,325 - models.yolo - INFO -  44                -2  1    262656  物体检测.YOLO_LEARN.models.common.Conv      [1024, 256, 1, 1]
2025-05-29 16:21:02,338 - models.yolo - INFO -  45                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,347 - models.yolo - INFO -  46                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,357 - models.yolo - INFO -  47                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,363 - models.yolo - INFO -  48                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,364 - models.yolo - INFO -  49  [-1, -3, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,386 - models.yolo - INFO -  50                -1  1   1050624  物体检测.YOLO_LEARN.models.common.Conv      [1024, 1024, 1, 1]
2025-05-29 16:21:02,422 - models.yolo - INFO -  51                -1  1   7609344  物体检测.YOLO_LEARN.models.common.SPPCSPC   [1024, 512, 1]
2025-05-29 16:21:02,428 - models.yolo - INFO -  52                -1  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,430 - models.yolo - INFO -  53                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
2025-05-29 16:21:02,434 - models.yolo - INFO -  54                37  1    262656  物体检测.YOLO_LEARN.models.common.Conv      [1024, 256, 1, 1]
2025-05-29 16:21:02,437 - models.yolo - INFO -  55          [-1, -2]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,442 - models.yolo - INFO -  56                -1  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,445 - models.yolo - INFO -  57                -2  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,448 - models.yolo - INFO -  58                -1  1    295168  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 3, 1]
2025-05-29 16:21:02,450 - models.yolo - INFO -  59                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,452 - models.yolo - INFO -  60                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,454 - models.yolo - INFO -  61                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,454 - models.yolo - INFO -  62[-1, -2, -3, -4, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,458 - models.yolo - INFO -  63                -1  1    262656  物体检测.YOLO_LEARN.models.common.Conv      [1024, 256, 1, 1]
2025-05-29 16:21:02,460 - models.yolo - INFO -  64                -1  1     33024  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 1, 1]
2025-05-29 16:21:02,461 - models.yolo - INFO -  65                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
2025-05-29 16:21:02,462 - models.yolo - INFO -  66                24  1     65792  物体检测.YOLO_LEARN.models.common.Conv      [512, 128, 1, 1]
2025-05-29 16:21:02,463 - models.yolo - INFO -  67          [-1, -2]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,463 - models.yolo - INFO -  68                -1  1     33024  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 1, 1]
2025-05-29 16:21:02,465 - models.yolo - INFO -  69                -2  1     33024  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 1, 1]
2025-05-29 16:21:02,467 - models.yolo - INFO -  70                -1  1     73856  物体检测.YOLO_LEARN.models.common.Conv      [128, 64, 3, 1]
2025-05-29 16:21:02,468 - models.yolo - INFO -  71                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,469 - models.yolo - INFO -  72                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,471 - models.yolo - INFO -  73                -1  1     36992  物体检测.YOLO_LEARN.models.common.Conv      [64, 64, 3, 1]
2025-05-29 16:21:02,473 - models.yolo - INFO -  74[-1, -2, -3, -4, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,474 - models.yolo - INFO -  75                -1  1     65792  物体检测.YOLO_LEARN.models.common.Conv      [512, 128, 1, 1]
2025-05-29 16:21:02,475 - models.yolo - INFO -  76                -1  1         0  物体检测.YOLO_LEARN.models.common.MP        []
2025-05-29 16:21:02,476 - models.yolo - INFO -  77                -1  1     16640  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 1, 1]
2025-05-29 16:21:02,478 - models.yolo - INFO -  78                -3  1     16640  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 1, 1]
2025-05-29 16:21:02,480 - models.yolo - INFO -  79                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 2]
2025-05-29 16:21:02,481 - models.yolo - INFO -  80      [-1, -3, 63]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,483 - models.yolo - INFO -  81                -1  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,486 - models.yolo - INFO -  82                -2  1    131584  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 1, 1]
2025-05-29 16:21:02,489 - models.yolo - INFO -  83                -1  1    295168  物体检测.YOLO_LEARN.models.common.Conv      [256, 128, 3, 1]
2025-05-29 16:21:02,491 - models.yolo - INFO -  84                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,495 - models.yolo - INFO -  85                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,498 - models.yolo - INFO -  86                -1  1    147712  物体检测.YOLO_LEARN.models.common.Conv      [128, 128, 3, 1]
2025-05-29 16:21:02,498 - models.yolo - INFO -  87[-1, -2, -3, -4, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,501 - models.yolo - INFO -  88                -1  1    262656  物体检测.YOLO_LEARN.models.common.Conv      [1024, 256, 1, 1]
2025-05-29 16:21:02,502 - models.yolo - INFO -  89                -1  1         0  物体检测.YOLO_LEARN.models.common.MP        []
2025-05-29 16:21:02,503 - models.yolo - INFO -  90                -1  1     66048  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 1, 1]
2025-05-29 16:21:02,506 - models.yolo - INFO -  91                -3  1     66048  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 1, 1]
2025-05-29 16:21:02,512 - models.yolo - INFO -  92                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 2]
2025-05-29 16:21:02,512 - models.yolo - INFO -  93      [-1, -3, 51]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,518 - models.yolo - INFO -  94                -1  1    525312  物体检测.YOLO_LEARN.models.common.Conv      [1024, 512, 1, 1]
2025-05-29 16:21:02,523 - models.yolo - INFO -  95                -2  1    525312  物体检测.YOLO_LEARN.models.common.Conv      [1024, 512, 1, 1]
2025-05-29 16:21:02,532 - models.yolo - INFO -  96                -1  1   1180160  物体检测.YOLO_LEARN.models.common.Conv      [512, 256, 3, 1]
2025-05-29 16:21:02,539 - models.yolo - INFO -  97                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,545 - models.yolo - INFO -  98                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,550 - models.yolo - INFO -  99                -1  1    590336  物体检测.YOLO_LEARN.models.common.Conv      [256, 256, 3, 1]
2025-05-29 16:21:02,551 - models.yolo - INFO - 100[-1, -2, -3, -4, -5, -6]  1         0  物体检测.YOLO_LEARN.models.common.Concat    [1]
2025-05-29 16:21:02,558 - models.yolo - INFO - 101                -1  1   1049600  物体检测.YOLO_LEARN.models.common.Conv      [2048, 512, 1, 1]
2025-05-29 16:21:02,563 - models.yolo - INFO - 102                75  1    328704  物体检测.YOLO_LEARN.models.common.RepConv   [128, 256, 3, 1]
2025-05-29 16:21:02,573 - models.yolo - INFO - 103                88  1   1312768  物体检测.YOLO_LEARN.models.common.RepConv   [256, 512, 3, 1]
2025-05-29 16:21:02,598 - models.yolo - INFO - 104               101  1   5246976  物体检测.YOLO_LEARN.models.common.RepConv   [512, 1024, 3, 1]
2025-05-29 16:21:03,256 - models.yolo - INFO - 105   [102, 103, 104]  1     61126  models.yolo.IDetect                     [6, [[12, 16, 19, 36, 40, 28], [36, 75, 76, 55, 72, 146], [142, 110, 192, 243, 459, 401]], [256, 512, 1024]]
D:\项目\微调\.venv\lib\site-packages\torch\functional.py:534: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at C:\actions-runner\_work\pytorch\pytorch\builder\windows\pytorch\aten\src\ATen\native\TensorShape.cpp:3596.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
2025-05-29 16:21:06,205 - 深度网络架构pytorch.text - INFO - Model Summary: 415 layers, 37223526 parameters, 37223526 gradients, 105.2 GFLOPS
2025-05-29 16:21:06,205 - models.yolo - INFO -
freeze--: []
2025-05-29 16:21:08,053 - __main__ - INFO - Scaled weight_decay = 0.0005
{'lr0': 0.01, 'lrf': 0.1, 'momentum': 0.937, 'weight_decay': 0.0005, 'warmup_epochs': 3.0, 'warmup_momentum': 0.8, 'warmup_bias_lr': 0.1, 'box': 0.05, 'cls': 0.3, 'cls_pw': 1.0, 'obj': 0.7, 'obj_pw': 1.0, 'iou_t': 0.2, 'anchor_t': 4.0, 'fl_gamma': 0.0, 'hsv_h': 0.015, 'hsv_s': 0.7, 'hsv_v': 0.4, 'degrees': 0.0, 'translate': 0.2, 'scale': 0.9, 'shear': 0.0, 'perspective': 0.0, 'flipud': 0.0, 'fliplr': 0.5, 'mosaic': 1.0, 'mixup': 0.15, 'copy_paste': 0.0, 'paste_in': 0.15, 'loss_ota': 1}
0.0005 1.0 -----
2025-05-29 16:21:09,551 - __main__ - INFO - Optimizer groups: 95 .bias, 95 conv.weight, 98 other
[34m[1mtrain: [0mScanning 'D:\PycharmProject\yolov7-main\NEU-DET\train' images and labels... 1770 found, 0 missing, 0 empty, 3 corrupted: 100%|██████████| 1770/1770 [20:43<00:00,  1.42it/s]
[34m[1mtrain: [0mWARNING: Ignoring corrupted image and/or label D:\\PycharmProject\\yolov7-main\\NEU-DET\\train\\images\\crazing_120.jpg: duplicate labels
[34m[1mtrain: [0mWARNING: Ignoring corrupted image and/or label D:\\PycharmProject\\yolov7-main\\NEU-DET\\train\\images\\inclusion_62.jpg: duplicate labels
[34m[1mtrain: [0mWARNING: Ignoring corrupted image and/or label D:\\PycharmProject\\yolov7-main\\NEU-DET\\train\\images\\patches_198.jpg: duplicate labels
2025-05-29 16:44:35,020 - root - INFO - [34m[1mtrain: [0mNew cache created: D:\PycharmProject\yolov7-main\NEU-DET\train.cache
False
[34m[1mval: [0mScanning 'D:\PycharmProject\yolov7-main\NEU-DET\val' images and labels... 30 found, 0 missing, 0 empty, 0 corrupted: 100%|██████████| 30/30 [01:01<00:00,  2.03s/it]
2025-05-29 16:51:41,230 - root - INFO - [34m[1mval: [0mNew cache created: D:\PycharmProject\yolov7-main\NEU-DET\val.cache
False

[34m[1mautoanchor: [0mAnalyzing anchors... anchors/target = 3.62, Best Possible Recall (BPR) = 0.9898
D:\项目\咕泡项目\物体检测\YOLO_LEARN\train.py:316: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = amp.GradScaler(enabled=cuda)#初始化梯度缩放器，用于混合精度训练，提高训练效率。
2025-05-29 17:55:36,083 - __main__ - INFO - Image sizes 640 train, 640 test
Using 1 dataloader workers
Logging results to runs\train\yolov711
Starting training for 20 epochs...
